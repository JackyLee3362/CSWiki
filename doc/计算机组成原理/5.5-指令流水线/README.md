## 5.5 指令流水线
- 指令流水线的基本概念
    - 指令流水的定义
        - 顺序执行方式
        - 流水线执行方式
        - 五级流水包括哪些?四级流水包括哪些? ?→①取指令IF ②指令译码ID ③取操作数OF ④执行EX ⑤写回WB ；
去掉取数操作OF
        - 指令集应具有如下特征
            - 指令长度应尽量一致，有利于简化取指令和指令译码操作
            - 指令格式应尽量规整
            - 采用Load/Store指令
            - 数据和指令在存储器中「对齐」存放
    - 流水线的表示方法
    - 流水线方式的特点
- 流水线的分类
    - 部件功能级、处理机级和处理机间级流水线
    - 单功能流水线和多功能流水线
    - 动态流水线和静态流水线
    - 线性流水线和非线性流水线
- 影响流水线的因素
    - 资源冲突
        - 为什么要暂停一个时钟周期?
    - 数据冲突
        - 写后读 Read After Write, RAW
        - 读后写 Write After Read, WAR
        - 写后写 Write After Write, WAW
        - 结合综合题3理解
    - 控制冲突
- 流水线的性能指标
    - 流水线的吞吐率
        - 定义
            - $$T_p = \frac n{T_k}$$
                - n是任务数
                - Tk是处理完n个任务所用的时间
        - 最大吞吐率
            - $$T_{pmax}=\frac 1{\Delta t}$$
        - 实际吞吐率
            - m段流水
            - $$T_p = \frac n{m\Delta t + (n-1)\Delta t}$$
    - 流水线的加速比
        - $$S_p = \frac{nm}{m+n-1}$$
    - 流水线的效率
        - 流水线中各功能段的利用率
            - $$E=\frac {流水线各段处于工作时间的时空区}{流水线中各段总的时空区}$$
- 超标量流水线的基本概念
    - 超标量流水线技术
    - 超流水线技术
        - 不能调整指令的执行顺序
    - 超长指令字
- ~结构冒险 数据冒险 控制冒险
### 习题
- 中断系统 哈工大计组p109开始
### 习题 
- 1 【2009】某计算机的指令流水线由4个功能段组成，指令流经各功能的时间（忽略各功能段之间的缓存时间）分别为90ns，80ns，70ns和60ns，则该计算机的CPU周期至少是→90ns
- 2 【2010】下列不会引起指令流水线阻塞的是
A 数据旁路
B 数据相关
C 条件转移
D 资源冲突→A，引起流水线阻塞的三个因素①数据冲突②资源冲突③控制冲突，主要由转移指令引起
- 5 【2017】
- 12【2013】
- 13【2016】在无转发机制的五段基本流水线（取指、译码/读寄存器、运算、访存、写回寄存器）中，下列指令序列存在数据冒险的指令对是
① add R1, R2, R3; (R2) + (R3) ⇒ R1
② add R5, R2, R4; (R2) + (R4) ⇒ R5
③ add R4, R5, R3; (R5) + (R3) ⇒ R4
④ add R5, R2, R6; (R2) + (R6) ⇒ R5
A①②  B②③  C②④  D③④→B
- 14【2017】下列关于指令流水线数据通路的叙述中，错误的是
A 包含生成控制信号
B 包含算术逻辑单元（ALU）
C 包含通用寄存器组和取指部件
D 由组合逻辑电路和时序逻辑电路组合而成→A，不包括控制部件
- 18【2019】
- 19【2018】若某计算机最复杂指令的执行需要完成5个子功能，分别由功能部件A~E实现，各功能部件所需时间分别是80ps、50ps、50ps、70ps和50ps，采用流水线方式执行指令，流水段寄存器延时20ps，则CPU时钟周期至少为→100ps
- 20【2020】下列给出的处理器类型中，理想情况下，CPI为1的是
① 单周期CPU
② 多周期CPU
③ 基本流水线CPU
④ 超标量流水线CPU→①③，①单周期CPU，指令周期 = 时钟周期②多周期CPU，CPI > 1③基本流水线CPU，理想情况下，CPI = 1④超标量流水线CPU，CPI < 1
- 综合题5【2012】
- 综合题6【2014】近年来最难，看书240，下面的综合题7是连着的→247
- 综合题7【2014】
